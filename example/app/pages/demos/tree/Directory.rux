def self.get_initial_state(initial_open: false, **)
  { open: initial_open }
end

def handle_toggle(_)
  update do |state|
    { open: !state[:open] }
  end
end

def render
  props => { root:, path:, entry: }

  entries =
    if state[:open]
      Dir
        .entries(File.join(root, path))
        .difference(%w[. ..])
        .sort
        .map do
          Mayu::VDOM.h(entry,
          root:,
          path: File.join(path, _1)
        )
        end.compact
      else
        []
      end

  icon = state[:open] ? "📂" : "📁"
  list_style_type = "'\\%s'" % icon.codepoints.first.to_s(16)

  <li style={{ list_style_type: }} class={styles[:dir, :nonempty, empty: entries.any?]}>
    <span class={styles[:name]} on-click={handler(:handle_toggle)}>
      {File.basename(path)}/
    </span>
    {entries.any? && <ul class={styles[:list]}>{entries}</ul>}
  </li>
end
